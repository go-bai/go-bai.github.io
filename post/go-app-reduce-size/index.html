<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>减小go程序编译后的体积 | gobai's blog</title><link rel=stylesheet href=/css/style.css><link rel=stylesheet href=/css/fonts.css><link href=//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/xcode.min.css rel=stylesheet></head><body><nav><ul class=menu><li><a href=/>Home</a></li><li><a href=/about/>About</a></li><li><a href=/tags/>Tags</a></li><li><a href=/index.xml>Subscribe</a></li></ul><hr></nav><div class=article-meta><h1><span class=title>减小go程序编译后的体积</span></h1><h4 class=date>2021/11/22</h4><p class=terms>Tags: <a href=/tags/golang>golang</a></p></div><main><h2 id=编译经典程序>编译经典程序</h2><h3 id=程序代码>程序代码</h3><pre><code class=language-go>package main

import &quot;fmt&quot;

func main() {
	fmt.Println(&quot;Hello World.&quot;)
}
</code></pre><h3 id=编译环境>编译环境</h3><pre><code class=language-bash>$ go version
go version go1.16.7 linux/amd64
</code></pre><h2 id=0-直接编译>0. 直接编译</h2><pre><code>$ go build -o helloword main.go
$ ls -lh helloword 
-rwxrwxr-x 1 gobai gobai 1.9M Nov 23 09:34 helloword
</code></pre><h2 id=1-修改编译选项>1. 修改编译选项</h2><p>除去编译时带的符号表和调试信息</p><pre><code class=language-bash>$ go build -ldflags=&quot;-s -w&quot; -o helloword main.go
$ ls -lh helloword 
-rwxrwxr-x 1 gobai gobai 1.3M Nov 23 09:38 helloword

</code></pre><h2 id=2-使用-upx>2. 使用 <code>UPX</code></h2><p>对直接编译出的二进制使用 <a href=https://github.com/upx/upx>upx</a> 进一步压缩</p><pre><code class=language-bash>$ go build -o helloword main.go
$ upx -9 helloword 
                       Ultimate Packer for eXecutables
                          Copyright (C) 1996 - 2020
UPX 3.96        Markus Oberhumer, Laszlo Molnar &amp; John Reiser   Jan 23rd 2020

        File size         Ratio      Format      Name
   --------------------   ------   -----------   -----------
   1937143 -&gt;   1105452   57.07%   linux/amd64   helloword                     

Packed 1 file.
$ ls -lh helloword 
-rwxrwxr-x 1 gobai gobai 1.1M Nov 23 09:40 helloword
</code></pre><h2 id=1和2组合使用>1和2组合使用</h2><pre><code class=language-bash>$ go build -ldflags=&quot;-s -w&quot; -o helloword main.go &amp;&amp; upx -9 helloword
                       Ultimate Packer for eXecutables
                          Copyright (C) 1996 - 2020
UPX 3.96        Markus Oberhumer, Laszlo Molnar &amp; John Reiser   Jan 23rd 2020

        File size         Ratio      Format      Name
   --------------------   ------   -----------   -----------
   1355776 -&gt;    543392   40.08%   linux/amd64   helloword                     

Packed 1 file.
$ ls -lh helloword 
-rwxrwxr-x 1 gobai gobai 531K Nov 23 09:42 helloword
</code></pre><p>可以看出，压缩效果显著！</p><p>参考链接</p><ul><li><a href=https://stackoverflow.com/questions/3861634/how-to-reduce-compiled-file-size>How to reduce compiled file size?</a></li></ul></main><footer><script defer src=https://cdn.jsdelivr.net/npm/@xiee/utils/js/center-img.js></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js></script>
<script>hljs.configure({languages:[]}),hljs.highlightAll()</script><hr>© <a href=https://blog.gocn.top>gobai</a> 2021 &ndash; 2023 | <a href=https://github.com/go-bai>Github</a></footer></body></html>