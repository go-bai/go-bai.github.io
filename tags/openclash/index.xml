<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>openclash on gobai's blog</title><link>/tags/openclash/</link><description>Recent content in openclash on gobai's blog</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Sat, 06 Jan 2024 17:38:38 +0800</lastBuildDate><atom:link href="/tags/openclash/index.xml" rel="self" type="application/rss+xml"/><item><title>OpenWrt</title><link>/posts/openwrt/</link><pubDate>Sat, 06 Jan 2024 17:38:38 +0800</pubDate><guid>/posts/openwrt/</guid><description>很久没折腾OpenWrt了, 囊中羞涩, 没有其他合适的设备, 这次是在KVM虚机中运行使用(ALL IN BOOM!)
准备qcow2镜像 首先下载最新的镜像, 截止目前最新版为23.05.2, 我这里下载的是x86-64的镜像
wget https://downloads.openwrt.org/releases/23.05.2/targets/x86/64/openwrt-23.05.2-x86-64-generic-ext4-combined.img.gz # 解压 gunzip openwrt-23.05.2-x86-64-generic-ext4-combined.img.gz # 这里因为我要作为KVM虚拟机的镜像, 所以转换为qcow2格式. 如果是在物理机上部署, 可以直接直接刷到U盘上. qemu-img convert -f raw openwrt-23.05.2-x86-64-generic-ext4-combined.img -O qcow2 openwrt.qcow2 # 默认virtual size只有120 MiB, 担心不够用所以增加到1GiB qemu-img resize openwrt.qcow2 +904M 运行虚机 我这里将镜像复制到了/var/lib/libvirt/disks/目录下
cp openwrt.qcow2 /var/lib/libvirt/disks/ 使用virt-install运行,
# 运行, 这里网络指定的之前文章中创建的网桥网络br0 virt-install --name openwrt --memory 256 --vcpus 1 --network bridge=br0,model=e1000 --disk path=/var/lib/libvirt/disks/openwrt.qcow2,bus=ide --import --autostart --osinfo detect=on,require=off --graphics vnc,listen=0.0.0.0 --noautoconsole 配置网络 连接console配置网络
virsh console openwrt 修改网络配置文件 /etc/config/network 只修改了lan配置, 其他都是默认的 具体修改了lan配置的ipaddr, 增加gateway和dns</description></item></channel></rss>