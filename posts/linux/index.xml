<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Linux on gobai's blog</title><link>/posts/linux/</link><description>Recent content in Linux on gobai's blog</description><generator>Hugo</generator><language>en-us</language><atom:link href="/posts/linux/index.xml" rel="self" type="application/rss+xml"/><item><title>Node Exporter</title><link>/posts/node-exporter/</link><pubDate>Wed, 03 Jul 2024 22:39:59 +0800</pubDate><guid>/posts/node-exporter/</guid><description>&lt;h2 id="node-exporter-安装">
 node-exporter 安装
 &lt;a class="anchor" href="#node-exporter-%e5%ae%89%e8%a3%85">#&lt;/a>
&lt;/h2>
&lt;h3 id="生成账号密码的-bcrypt-hash">
 生成账号密码的 bcrypt hash
 &lt;a class="anchor" href="#%e7%94%9f%e6%88%90%e8%b4%a6%e5%8f%b7%e5%af%86%e7%a0%81%e7%9a%84-bcrypt-hash">#&lt;/a>
&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>apt install apache2-utils -y
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>生成一个账号密码的 bcrypt hash&lt;/p>
&lt;ul>
&lt;li>&lt;code>-B&lt;/code> 强制使用 bcrypt 算法&lt;/li>
&lt;li>&lt;code>-C 10&lt;/code> 指定 bcrypt 的 cost 值为 10, golang bcrypt 默认 cost 值也为 10&lt;/li>
&lt;/ul>
&lt;p>注意修改下面的 &lt;code>username&lt;/code> 和 &lt;code>password&lt;/code> 为你要设置的账号密码&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># htpasswd -nbBC 10 username password&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>username:$2y$10$poDYDLemE3r95gcQ.h8FdODudFaFZhwZCSX1RTwpI2s8V4Mwm0.lO
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h4 id="关于-bcrypt">
 关于 bcrypt
 &lt;a class="anchor" href="#%e5%85%b3%e4%ba%8e-bcrypt">#&lt;/a>
&lt;/h4>
&lt;p>格式为 &lt;code>$2&amp;lt;a/b/x/y&amp;gt;$[cost]$[22 character salt][31 character hash]&lt;/code>&lt;/p>
&lt;p>例如&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>$2y$10$poDYDLemE3r95gcQ.h8FdODudFaFZhwZCSX1RTwpI2s8V4Mwm0.lO
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">\_&lt;/span>_/&lt;span style="color:#ae81ff">\/&lt;/span> &lt;span style="color:#ae81ff">\_&lt;/span>___________________/&lt;span style="color:#ae81ff">\_&lt;/span>____________________________/
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Alg Cost Salt Hash
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="运行-node-exporter">
 运行 node-exporter
 &lt;a class="anchor" href="#%e8%bf%90%e8%a1%8c-node-exporter">#&lt;/a>
&lt;/h3>
&lt;ol>
&lt;li>创建 &lt;code>prometheus&lt;/code> 配置文件 &lt;code>/etc/prometheus/web.yml&lt;/code>&lt;/li>
&lt;li>创建 &lt;code>docker-compose.yml&lt;/code> 文件&lt;/li>
&lt;li>运行 docker compose&lt;/li>
&lt;/ol>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>PASS&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#39;$2y$10$poDYDLemE3r95gcQ.h8FdODudFaFZhwZCSX1RTwpI2s8V4Mwm0.lO&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>mkdir -p /etc/prometheus
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>cat &lt;span style="color:#e6db74">&amp;lt;&amp;lt;EOF&amp;gt; /etc/prometheus/web.yml
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">basic_auth_users:
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74"> # username: password
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74"> prometheus: ${PASS}
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">EOF&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>cat &lt;span style="color:#e6db74">&amp;lt;&amp;lt;EOF&amp;gt; /etc/prometheus/docker-compose.yml
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">services:
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74"> node-exporter:
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74"> image: quay.io/prometheus/node-exporter:latest
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74"> container_name: node-exporter
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74"> command: 
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74"> - &amp;#34;--path.rootfs=/host&amp;#34;
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74"> - &amp;#34;--web.config.file=/etc/prometheus/web.yml&amp;#34;
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74"> network_mode: &amp;#34;host&amp;#34;
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74"> pid: host
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74"> restart: always
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74"> volumes:
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74"> - &amp;#39;/:/host:ro,rslave&amp;#39;
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74"> - /etc/prometheus/web.yml:/etc/prometheus/web.yml
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#e6db74">EOF&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>docker compose -f /etc/prometheus/docker-compose.yml up -d
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="在-prometheus-中配置指标收集">
 在 prometheus 中配置指标收集
 &lt;a class="anchor" href="#%e5%9c%a8-prometheus-%e4%b8%ad%e9%85%8d%e7%bd%ae%e6%8c%87%e6%a0%87%e6%94%b6%e9%9b%86">#&lt;/a>
&lt;/h2>
&lt;h3 id="方式一直接修改-prometheus-配置">
 方式一：直接修改 prometheus 配置
 &lt;a class="anchor" href="#%e6%96%b9%e5%bc%8f%e4%b8%80%e7%9b%b4%e6%8e%a5%e4%bf%ae%e6%94%b9-prometheus-%e9%85%8d%e7%bd%ae">#&lt;/a>
&lt;/h3>
&lt;p>修改 &lt;code>kube-prometheus-stack&lt;/code> chart 配置并更新，或者直接修改保存配置的 configmap 中的 job 配置, 记得修改 &lt;code>{EDIT_HERE}&lt;/code> 为实际值&lt;/p></description></item><item><title>Rclone 使用笔记</title><link>/posts/rclone/</link><pubDate>Thu, 04 Apr 2024 15:56:58 +0800</pubDate><guid>/posts/rclone/</guid><description>&lt;blockquote>
&lt;p>使用&lt;code>rclone&lt;/code>和&lt;code>alist&lt;/code>提供的&lt;code>webdav&lt;/code>接口将阿里云盘&lt;code>mount&lt;/code>到Ubuntu 22.04的目录上, 实现像访问本地文件一样访问阿里云盘内的文件&lt;/p>&lt;/blockquote>
&lt;h2 id="下载安装rclone">
 下载安装&lt;code>rclone&lt;/code>
 &lt;a class="anchor" href="#%e4%b8%8b%e8%bd%bd%e5%ae%89%e8%a3%85rclone">#&lt;/a>
&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>curl https://rclone.org/install.sh | bash
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="配置rclone-config">
 配置&lt;code>rclone config&lt;/code>
 &lt;a class="anchor" href="#%e9%85%8d%e7%bd%aerclone-config">#&lt;/a>
&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># rclone config&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>No remotes found, make a new one?
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>n&lt;span style="color:#f92672">)&lt;/span> New remote
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>s&lt;span style="color:#f92672">)&lt;/span> Set configuration password
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>q&lt;span style="color:#f92672">)&lt;/span> Quit config
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>n/s/q&amp;gt; n
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Enter name &lt;span style="color:#66d9ef">for&lt;/span> new remote.
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>name&amp;gt; alist
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Option Storage.
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Type of storage to configure.
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Choose a number from below, or type in your own value.
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">1&lt;/span> / 1Fichier
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">\ &lt;/span>&lt;span style="color:#f92672">(&lt;/span>fichier&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>...
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">51&lt;/span> / WebDAV
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">\ &lt;/span>&lt;span style="color:#f92672">(&lt;/span>webdav&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>...
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Storage&amp;gt; &lt;span style="color:#ae81ff">51&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Option url.
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>URL of http host to connect to.
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>E.g. https://example.com.
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Enter a value.
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>url&amp;gt; http://alist.home.lan/dav/
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Option vendor.
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Name of the WebDAV site/service/software you are using.
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Choose a number from below, or type in your own value.
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Press Enter to leave empty.
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">1&lt;/span> / Fastmail Files
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">\ &lt;/span>&lt;span style="color:#f92672">(&lt;/span>fastmail&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">2&lt;/span> / Nextcloud
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">\ &lt;/span>&lt;span style="color:#f92672">(&lt;/span>nextcloud&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">3&lt;/span> / Owncloud
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">\ &lt;/span>&lt;span style="color:#f92672">(&lt;/span>owncloud&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">4&lt;/span> / Sharepoint Online, authenticated by Microsoft account
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">\ &lt;/span>&lt;span style="color:#f92672">(&lt;/span>sharepoint&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">5&lt;/span> / Sharepoint with NTLM authentication, usually self-hosted or on-premises
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">\ &lt;/span>&lt;span style="color:#f92672">(&lt;/span>sharepoint-ntlm&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">6&lt;/span> / rclone WebDAV server to serve a remote over HTTP via the WebDAV protocol
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">\ &lt;/span>&lt;span style="color:#f92672">(&lt;/span>rclone&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">7&lt;/span> / Other site/service or software
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">\ &lt;/span>&lt;span style="color:#f92672">(&lt;/span>other&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>vendor&amp;gt; &lt;span style="color:#ae81ff">7&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Option user.
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>User name.
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>In &lt;span style="color:#66d9ef">case&lt;/span> NTLM authentication is used, the username should be in the format &lt;span style="color:#e6db74">&amp;#39;Domain\User&amp;#39;&lt;/span>.
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Enter a value. Press Enter to leave empty.
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>user&amp;gt; admin
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Option pass.
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Password.
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Choose an alternative below. Press Enter &lt;span style="color:#66d9ef">for&lt;/span> the default &lt;span style="color:#f92672">(&lt;/span>n&lt;span style="color:#f92672">)&lt;/span>.
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>y&lt;span style="color:#f92672">)&lt;/span> Yes, type in my own password
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>g&lt;span style="color:#f92672">)&lt;/span> Generate random password
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>n&lt;span style="color:#f92672">)&lt;/span> No, leave this optional password blank &lt;span style="color:#f92672">(&lt;/span>default&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>y/g/n&amp;gt; y
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Enter the password:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>password:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Confirm the password:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>password:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Option bearer_token.
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Bearer token instead of user/pass &lt;span style="color:#f92672">(&lt;/span>e.g. a Macaroon&lt;span style="color:#f92672">)&lt;/span>.
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Enter a value. Press Enter to leave empty.
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>bearer_token&amp;gt;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Edit advanced config?
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>y&lt;span style="color:#f92672">)&lt;/span> Yes
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>n&lt;span style="color:#f92672">)&lt;/span> No &lt;span style="color:#f92672">(&lt;/span>default&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>y/n&amp;gt; n
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Configuration complete.
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Options:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>- type: webdav
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>- url: http://alist.home.lan/dav/
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>- vendor: other
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>- user: admin
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>- pass: *** ENCRYPTED ***
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Keep this &lt;span style="color:#e6db74">&amp;#34;alist&amp;#34;&lt;/span> remote?
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>y&lt;span style="color:#f92672">)&lt;/span> Yes this is OK &lt;span style="color:#f92672">(&lt;/span>default&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>e&lt;span style="color:#f92672">)&lt;/span> Edit this remote
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>d&lt;span style="color:#f92672">)&lt;/span> Delete this remote
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>y/e/d&amp;gt; y
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Current remotes:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Name Type
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">====&lt;/span> &lt;span style="color:#f92672">====&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>alist webdav
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>e&lt;span style="color:#f92672">)&lt;/span> Edit existing remote
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>n&lt;span style="color:#f92672">)&lt;/span> New remote
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>d&lt;span style="color:#f92672">)&lt;/span> Delete remote
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>r&lt;span style="color:#f92672">)&lt;/span> Rename remote
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>c&lt;span style="color:#f92672">)&lt;/span> Copy remote
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>s&lt;span style="color:#f92672">)&lt;/span> Set configuration password
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>q&lt;span style="color:#f92672">)&lt;/span> Quit config
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>e/n/d/r/c/s/q&amp;gt; q
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="查看有哪些remote">
 查看有哪些remote
 &lt;a class="anchor" href="#%e6%9f%a5%e7%9c%8b%e6%9c%89%e5%93%aa%e4%ba%9bremote">#&lt;/a>
&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># rclone listremotes&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>alist:
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="查看某个remote下的目录或文件">
 查看某个&lt;code>remote&lt;/code>下的目录或文件
 &lt;a class="anchor" href="#%e6%9f%a5%e7%9c%8b%e6%9f%90%e4%b8%aaremote%e4%b8%8b%e7%9a%84%e7%9b%ae%e5%bd%95%e6%88%96%e6%96%87%e4%bb%b6">#&lt;/a>
&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># rclone lsd alist:/ali/video/诛仙&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> -1 2024-04-02 12:27:23 -1 诛仙.第1季.2022-2023.4K.全26集
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> -1 2024-04-02 12:27:24 -1 诛仙.第2季.2024
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># rclone ls alist:/ali/video/诛仙/诛仙.第2季.2024&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">959919343&lt;/span> 第27集-Zhu.Xian-2024-03-29-4k-HEVC-H265.AAC-WEB-DL.mkv
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">995844543&lt;/span> 第28集-Zhu.Xian-2024-03-29-4K-HEVC-H265.AAC-WEB-DL.mkv
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">1012470661&lt;/span> 第29集-Zhu.Xian-2024-03-29-4K-HEVC-H265.AAC-WEB-DL.mkv
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="将alist-mount-到目录">
 将&lt;code>alist&lt;/code> mount 到目录
 &lt;a class="anchor" href="#%e5%b0%86alist-mount-%e5%88%b0%e7%9b%ae%e5%bd%95">#&lt;/a>
&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>sudo mkdir -p /mnt/alist
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sudo chmod &lt;span style="color:#ae81ff">777&lt;/span> /mnt/alist
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># --header &amp;#34;Referer:https://www.aliyundrive.com/&amp;#34; 是必须要有的&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>rclone mount --cache-dir&lt;span style="color:#f92672">=&lt;/span>/tmp --vfs-cache-mode&lt;span style="color:#f92672">=&lt;/span>writes --header &lt;span style="color:#e6db74">&amp;#34;Referer:https://www.aliyundrive.com/&amp;#34;&lt;/span> alist: /mnt/alist/
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>配置开机自动挂载&lt;/p></description></item><item><title>Multi-Bootable USB</title><link>/posts/multi-bootable-usb/</link><pubDate>Thu, 28 Mar 2024 22:20:22 +0800</pubDate><guid>/posts/multi-bootable-usb/</guid><description>&lt;blockquote>
&lt;p>从一个USB设备(U盘)启动多个操作系统, 并且U盘还能继续存储其他普通文件&lt;/p>&lt;/blockquote>
&lt;h2 id="下载并解压ventoy">
 下载并解压&lt;code>ventoy&lt;/code>
 &lt;a class="anchor" href="#%e4%b8%8b%e8%bd%bd%e5%b9%b6%e8%a7%a3%e5%8e%8bventoy">#&lt;/a>
&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>wget https://github.com/ventoy/Ventoy/releases/download/v1.0.97/ventoy-1.0.97-linux.tar.gz
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>tar -xvzf ventoy-1.0.97-linux.tar.gz
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>cd ventoy-1.0.97/
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>&lt;code>Ventoy2Disk.sh&lt;/code>用来安装&lt;code>ventor&lt;/code>到U盘&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>./Ventoy2Disk.sh -h
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>**********************************************
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Ventoy: 1.0.97 x86_64
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> longpanda admin@ventoy.net
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> https://www.ventoy.net
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>**********************************************
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Usage: Ventoy2Disk.sh CMD &lt;span style="color:#f92672">[&lt;/span> OPTION &lt;span style="color:#f92672">]&lt;/span> /dev/sdX
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> CMD:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> -i install Ventoy to sdX &lt;span style="color:#f92672">(&lt;/span>fails &lt;span style="color:#66d9ef">if&lt;/span> disk already installed with Ventoy&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> -I force install Ventoy to sdX &lt;span style="color:#f92672">(&lt;/span>no matter &lt;span style="color:#66d9ef">if&lt;/span> installed or not&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> -u update Ventoy in sdX
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> -l list Ventoy information in sdX
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> OPTION: &lt;span style="color:#f92672">(&lt;/span>optional&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> -r SIZE_MB preserve some space at the bottom of the disk &lt;span style="color:#f92672">(&lt;/span>only &lt;span style="color:#66d9ef">for&lt;/span> install&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> -s/-S enable/disable secure boot support &lt;span style="color:#f92672">(&lt;/span>default is enabled&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> -g use GPT partition style, default is MBR &lt;span style="color:#f92672">(&lt;/span>only &lt;span style="color:#66d9ef">for&lt;/span> install&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> -L Label of the 1st exfat partition &lt;span style="color:#f92672">(&lt;/span>default is Ventoy&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> -n try non-destructive installation &lt;span style="color:#f92672">(&lt;/span>only &lt;span style="color:#66d9ef">for&lt;/span> install&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="安装ventoy">
 安装ventoy
 &lt;a class="anchor" href="#%e5%ae%89%e8%a3%85ventoy">#&lt;/a>
&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># ./Ventoy2Disk.sh -I /dev/sdb&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>**********************************************
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> Ventoy: 1.0.97 x86_64
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> longpanda admin@ventoy.net
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> https://www.ventoy.net
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>**********************************************
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Disk : /dev/sdb
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Model: Kingston DataTraveler 3.0 &lt;span style="color:#f92672">(&lt;/span>scsi&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Size : &lt;span style="color:#ae81ff">115&lt;/span> GB
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Style: MBR
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Attention:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>You will install Ventoy to /dev/sdb.
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>All the data on the disk /dev/sdb will be lost!!!
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Continue? &lt;span style="color:#f92672">(&lt;/span>y/n&lt;span style="color:#f92672">)&lt;/span> y
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>All the data on the disk /dev/sdb will be lost!!!
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Double-check. Continue? &lt;span style="color:#f92672">(&lt;/span>y/n&lt;span style="color:#f92672">)&lt;/span> y
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Create partitions on /dev/sdb by parted in MBR style ...
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Done
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Wait &lt;span style="color:#66d9ef">for&lt;/span> partitions ...
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>partition exist OK
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>create efi fat fs /dev/sdb2 ...
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>mkfs.fat 4.2 &lt;span style="color:#f92672">(&lt;/span>2021-01-31&lt;span style="color:#f92672">)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>success
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Wait &lt;span style="color:#66d9ef">for&lt;/span> partitions ...
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>/dev/sdb1 exist OK
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>/dev/sdb2 exist OK
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>partition exist OK
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Format partition &lt;span style="color:#ae81ff">1&lt;/span> /dev/sdb1 ...
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>mkexfatfs 1.3.0
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Creating... &lt;span style="color:#66d9ef">done&lt;/span>.
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Flushing... &lt;span style="color:#66d9ef">done&lt;/span>.
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>File system created successfully.
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>mkexfatfs success
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>writing data to disk ...
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sync data ...
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>esp partition processing ...
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Install Ventoy to /dev/sdb successfully finished.
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>查看最终的U盘分区, &lt;code>sdb1&lt;/code>分区是存放&lt;code>iso&lt;/code>镜像的&lt;/p></description></item><item><title>Shell Script</title><link>/posts/shell-script/</link><pubDate>Sat, 23 Mar 2024 09:43:34 +0800</pubDate><guid>/posts/shell-script/</guid><description>&lt;blockquote>
&lt;p>最近写的shell脚本比较多，记录一些常用命令, 相当于记录一个索引, 以后用时可以快速回忆起来.&lt;/p>&lt;/blockquote>
&lt;h2 id="binbash">
 &lt;code>#!/bin/bash&lt;/code>
 &lt;a class="anchor" href="#binbash">#&lt;/a>
&lt;/h2>
&lt;p>&lt;code>#!/bin/bash&lt;/code>被称为&lt;code>shebang line&lt;/code>, 指定执行此脚本文件时使用&lt;code>/bin/bash&lt;/code>做为shell解释器程序&lt;/p>
&lt;p>很多主流操作系统默认的shell解释器也是bash&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># echo $SHELL&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>/bin/bash
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="set">
 &lt;code>set&lt;/code>
 &lt;a class="anchor" href="#set">#&lt;/a>
&lt;/h2>
&lt;p>&lt;code>set&lt;/code>命令用来修改shell环境的运行参数, 完整的可定制的&lt;a href="https://www.gnu.org/software/bash/manual/html_node/The-Set-Builtin.html">官方手册&lt;/a>&lt;/p>
&lt;p>下面是我常用的几个, 可以合并为如下内容写在脚本开头:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#!/bin/bash
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>set -uxe
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>set -o pipefail
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="set--u">
 &lt;code>set -u&lt;/code>
 &lt;a class="anchor" href="#set--u">#&lt;/a>
&lt;/h3>
&lt;p>执行脚本时, 如果遇到不存在的变量, Bash默认会忽略, &lt;code>set -u&lt;/code>可以让脚本读到不存在变量时报错&lt;/p>
&lt;h3 id="set--x">
 &lt;code>set -x&lt;/code>
 &lt;a class="anchor" href="#set--x">#&lt;/a>
&lt;/h3>
&lt;p>命令执行前会先打印出来, 行首以&lt;code>+&lt;/code>表示, 在调试脚本时非常有帮助&lt;/p>
&lt;h3 id="set--e">
 &lt;code>set -e&lt;/code>
 &lt;a class="anchor" href="#set--e">#&lt;/a>
&lt;/h3>
&lt;p>执行脚本时, Bash遇到错误默认会继续执行, &lt;code>set -e&lt;/code>使得脚本只要发生错误, 就中止执行&lt;/p>
&lt;h3 id="set--o-pipefail">
 &lt;code>set -o pipefail&lt;/code>
 &lt;a class="anchor" href="#set--o-pipefail">#&lt;/a>
&lt;/h3>
&lt;p>&lt;code>set -e&lt;/code>有一个例外情况, 就是不适用于管道命令, 比如下面的不会退出&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">#!/bin/bash
&lt;/span>&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e">&lt;/span>set -e
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>foo | echo a
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>echo bar
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>执行的结果为:&lt;/p></description></item><item><title>删除分区并扩容另一个分区和根文件系统</title><link>/posts/delete-partition-and-expand-another/</link><pubDate>Mon, 02 Oct 2023 16:54:05 +0800</pubDate><guid>/posts/delete-partition-and-expand-another/</guid><description>&lt;blockquote>
&lt;p>现在要将 &lt;code>/dev/sda3&lt;/code> 分区删掉并扩容到 &lt;code>/dev/sda2&lt;/code>, 并且在不重启服务器的情况下扩容根文件系统(跟文件系统 &lt;code>/&lt;/code> 挂载在 &lt;code>/dev/sda2&lt;/code> 上, 并且 filesystem 是 &lt;code>ext4&lt;/code>)&lt;/p>&lt;/blockquote>
&lt;h2 id="磁盘初始分区和挂载情况">
 磁盘初始分区和挂载情况
 &lt;a class="anchor" href="#%e7%a3%81%e7%9b%98%e5%88%9d%e5%a7%8b%e5%88%86%e5%8c%ba%e5%92%8c%e6%8c%82%e8%bd%bd%e6%83%85%e5%86%b5">#&lt;/a>
&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>➜ ~ lsblk /dev/sda
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>NAME MAJ:MIN RM SIZE RO TYPE MOUNTPOINT
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>sda 8:0 &lt;span style="color:#ae81ff">0&lt;/span> 100G &lt;span style="color:#ae81ff">0&lt;/span> disk 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>├─sda1 8:1 &lt;span style="color:#ae81ff">0&lt;/span> 512M &lt;span style="color:#ae81ff">0&lt;/span> part /boot/efi
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>├─sda2 8:2 &lt;span style="color:#ae81ff">0&lt;/span> 98.5G &lt;span style="color:#ae81ff">0&lt;/span> part /
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>└─sda3 8:3 &lt;span style="color:#ae81ff">0&lt;/span> 976M &lt;span style="color:#ae81ff">0&lt;/span> part 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>➜ ~ fdisk -l /dev/sda
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Disk /dev/sda: &lt;span style="color:#ae81ff">100&lt;/span> GiB, &lt;span style="color:#ae81ff">107374182400&lt;/span> bytes, &lt;span style="color:#ae81ff">209715200&lt;/span> sectors
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Disk model: BlockVolume 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Units: sectors of &lt;span style="color:#ae81ff">1&lt;/span> * 512 &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">512&lt;/span> bytes
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Sector size &lt;span style="color:#f92672">(&lt;/span>logical/physical&lt;span style="color:#f92672">)&lt;/span>: &lt;span style="color:#ae81ff">512&lt;/span> bytes / &lt;span style="color:#ae81ff">4096&lt;/span> bytes
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>I/O size &lt;span style="color:#f92672">(&lt;/span>minimum/optimal&lt;span style="color:#f92672">)&lt;/span>: &lt;span style="color:#ae81ff">4096&lt;/span> bytes / &lt;span style="color:#ae81ff">1048576&lt;/span> bytes
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Disklabel type: gpt
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Disk identifier: 40BED670-8B91-4520-9785-DB1F1035C039
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Device Start End Sectors Size Type
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>/dev/sda1 &lt;span style="color:#ae81ff">2048&lt;/span> &lt;span style="color:#ae81ff">1050623&lt;/span> &lt;span style="color:#ae81ff">1048576&lt;/span> 512M EFI System
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>/dev/sda2 &lt;span style="color:#ae81ff">1050624&lt;/span> &lt;span style="color:#ae81ff">207714303&lt;/span> &lt;span style="color:#ae81ff">206663680&lt;/span> 98.5G Linux filesystem
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>/dev/sda3 &lt;span style="color:#ae81ff">207714304&lt;/span> &lt;span style="color:#ae81ff">209713151&lt;/span> &lt;span style="color:#ae81ff">1998848&lt;/span> 976M Linux swap
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>➜ ~ df -hT /dev/sda2
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Filesystem Type Size Used Avail Use% Mounted on
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>/dev/sda2 ext4 97G 28G 64G 31% /
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="删除分区-devsda3">
 删除分区 &lt;code>/dev/sda3&lt;/code>
 &lt;a class="anchor" href="#%e5%88%a0%e9%99%a4%e5%88%86%e5%8c%ba-devsda3">#&lt;/a>
&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>➜ ~ fdisk /dev/sda
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Welcome to fdisk &lt;span style="color:#f92672">(&lt;/span>util-linux 2.36.1&lt;span style="color:#f92672">)&lt;/span>.
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Changes will remain in memory only, &lt;span style="color:#66d9ef">until&lt;/span> you decide to write them.
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Be careful before using the write command.
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Command &lt;span style="color:#f92672">(&lt;/span>m &lt;span style="color:#66d9ef">for&lt;/span> help&lt;span style="color:#f92672">)&lt;/span>: d
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Partition number &lt;span style="color:#f92672">(&lt;/span>1-3, default 3&lt;span style="color:#f92672">)&lt;/span>: &lt;span style="color:#ae81ff">3&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Partition &lt;span style="color:#ae81ff">3&lt;/span> has been deleted.
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Command &lt;span style="color:#f92672">(&lt;/span>m &lt;span style="color:#66d9ef">for&lt;/span> help&lt;span style="color:#f92672">)&lt;/span>: p
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Disk /dev/sda: &lt;span style="color:#ae81ff">100&lt;/span> GiB, &lt;span style="color:#ae81ff">107374182400&lt;/span> bytes, &lt;span style="color:#ae81ff">209715200&lt;/span> sectors
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Disk model: BlockVolume 
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Units: sectors of &lt;span style="color:#ae81ff">1&lt;/span> * 512 &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#ae81ff">512&lt;/span> bytes
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Sector size &lt;span style="color:#f92672">(&lt;/span>logical/physical&lt;span style="color:#f92672">)&lt;/span>: &lt;span style="color:#ae81ff">512&lt;/span> bytes / &lt;span style="color:#ae81ff">4096&lt;/span> bytes
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>I/O size &lt;span style="color:#f92672">(&lt;/span>minimum/optimal&lt;span style="color:#f92672">)&lt;/span>: &lt;span style="color:#ae81ff">4096&lt;/span> bytes / &lt;span style="color:#ae81ff">1048576&lt;/span> bytes
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Disklabel type: gpt
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Disk identifier: 40BED670-8B91-4520-9785-DB1F1035C039
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Device Start End Sectors Size Type
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>/dev/sda1 &lt;span style="color:#ae81ff">2048&lt;/span> &lt;span style="color:#ae81ff">1050623&lt;/span> &lt;span style="color:#ae81ff">1048576&lt;/span> 512M EFI System
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>/dev/sda2 &lt;span style="color:#ae81ff">1050624&lt;/span> &lt;span style="color:#ae81ff">207714303&lt;/span> &lt;span style="color:#ae81ff">206663680&lt;/span> 98.5G Linux filesystem
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Command &lt;span style="color:#f92672">(&lt;/span>m &lt;span style="color:#66d9ef">for&lt;/span> help&lt;span style="color:#f92672">)&lt;/span>: w &lt;span style="color:#75715e"># 保存退出&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>The partition table has been altered.
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Syncing disks.
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="扩容分区-devsda2-和-根文件系统">
 扩容分区 &lt;code>/dev/sda2&lt;/code> 和 根文件系统
 &lt;a class="anchor" href="#%e6%89%a9%e5%ae%b9%e5%88%86%e5%8c%ba-devsda2-%e5%92%8c-%e6%a0%b9%e6%96%87%e4%bb%b6%e7%b3%bb%e7%bb%9f">#&lt;/a>
&lt;/h2>
&lt;p>使用 &lt;code>fdisk&lt;/code> 扩容 &lt;code>/dev/sda2&lt;/code>, 前提是 &lt;code>/dev/sda2&lt;/code> 后面没有其他分区了，可以这样扩容(先删除不退出并重建分区, 分区 &lt;code>Start&lt;/code> 不变, &lt;code>End&lt;/code> 增大)&lt;/p></description></item><item><title>Ubuntu Config</title><link>/posts/ubuntu-config/</link><pubDate>Sun, 24 Sep 2023 10:56:12 +0800</pubDate><guid>/posts/ubuntu-config/</guid><description>&lt;blockquote>
&lt;p>以下配置都是在 &lt;code>Ubuntu 22.04&lt;/code> 系统配置&lt;/p>&lt;/blockquote>
&lt;h2 id="配置中文输入法">
 配置中文输入法
 &lt;a class="anchor" href="#%e9%85%8d%e7%bd%ae%e4%b8%ad%e6%96%87%e8%be%93%e5%85%a5%e6%b3%95">#&lt;/a>
&lt;/h2>
&lt;ol>
&lt;li>Open Settings, go to &lt;code>Region &amp;amp; Language&lt;/code> -&amp;gt; &lt;code>Manage Installed Languages&lt;/code> -&amp;gt; &lt;code>Install / Remove languages&lt;/code>.&lt;/li>
&lt;li>Select &lt;code>Chinese (Simplified)&lt;/code>. Make sure &lt;code>Keyboard Input method system&lt;/code> has &lt;code>Ibus&lt;/code> selected. Apply.&lt;/li>
&lt;li>Reboot&lt;/li>
&lt;li>Log back in, reopen Settings, go to &lt;code>Keyboard&lt;/code>.&lt;/li>
&lt;li>Click on the &amp;ldquo;+&amp;rdquo; sign under &lt;code>Input sources&lt;/code>.&lt;/li>
&lt;li>Select &lt;code>Chinese (China)&lt;/code> and then &lt;code>Chinese (Intelligent Pinyin)&lt;/code>.&lt;/li>
&lt;/ol>
&lt;p>&lt;a href="https://askubuntu.com/questions/1408873/ubuntu-22-04-chinese-simplified-pinyin-input-support">ubuntu-22-04-chinese-simplified-pinyin-input-support&lt;/a>&lt;/p>
&lt;h2 id="修正简体中文显示为异体日文字形">
 修正简体中文显示为异体(日文)字形
 &lt;a class="anchor" href="#%e4%bf%ae%e6%ad%a3%e7%ae%80%e4%bd%93%e4%b8%ad%e6%96%87%e6%98%be%e7%a4%ba%e4%b8%ba%e5%bc%82%e4%bd%93%e6%97%a5%e6%96%87%e5%ad%97%e5%bd%a2">#&lt;/a>
&lt;/h2>
&lt;blockquote>
&lt;p>ubuntu/linux对中文支持的不太好, 在选择汉字字体时, 优先选择的是日文或者韩文, 需要手动调整优先级后重启操作系统解决&lt;/p></description></item><item><title>About Systemd</title><link>/posts/systemd-journal/</link><pubDate>Sun, 14 Nov 2021 01:47:04 +0800</pubDate><guid>/posts/systemd-journal/</guid><description>&lt;p>记录一下查看和操作 &lt;code>systemd&lt;/code> 日志的几个常用命令&lt;/p>
&lt;h2 id="常用过滤日志日志的命令">
 常用过滤日志日志的命令
 &lt;a class="anchor" href="#%e5%b8%b8%e7%94%a8%e8%bf%87%e6%bb%a4%e6%97%a5%e5%bf%97%e6%97%a5%e5%bf%97%e7%9a%84%e5%91%bd%e4%bb%a4">#&lt;/a>
&lt;/h2>
&lt;h3 id="根据时间约束过滤日志">
 根据时间约束过滤日志
 &lt;a class="anchor" href="#%e6%a0%b9%e6%8d%ae%e6%97%b6%e9%97%b4%e7%ba%a6%e6%9d%9f%e8%bf%87%e6%bb%a4%e6%97%a5%e5%bf%97">#&lt;/a>
&lt;/h3>
&lt;h4 id="获取-2023-01-15-000000-之后的日志">
 获取 &lt;code>2023-01-15 00:00:00&lt;/code> 之后的日志
 &lt;a class="anchor" href="#%e8%8e%b7%e5%8f%96-2023-01-15-000000-%e4%b9%8b%e5%90%8e%e7%9a%84%e6%97%a5%e5%bf%97">#&lt;/a>
&lt;/h4>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>journalctl --since &lt;span style="color:#e6db74">&amp;#39;2023-01-15 00:00:00&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h4 id="获取-2023-01-15-000000-之后-2023-01-15-120000-之前的日志">
 获取 &lt;code>2023-01-15 00:00:00&lt;/code> 之后, &lt;code>2023-01-15 12:00:00&lt;/code> 之前的日志
 &lt;a class="anchor" href="#%e8%8e%b7%e5%8f%96-2023-01-15-000000-%e4%b9%8b%e5%90%8e-2023-01-15-120000-%e4%b9%8b%e5%89%8d%e7%9a%84%e6%97%a5%e5%bf%97">#&lt;/a>
&lt;/h4>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>journalctl --since &lt;span style="color:#e6db74">&amp;#39;2023-01-15 00:00:00&amp;#39;&lt;/span> --until &lt;span style="color:#e6db74">&amp;#39;2023-01-15 12:00:00&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="只查看一个服务unit的日志">
 只查看一个服务(Unit)的日志
 &lt;a class="anchor" href="#%e5%8f%aa%e6%9f%a5%e7%9c%8b%e4%b8%80%e4%b8%aa%e6%9c%8d%e5%8a%a1unit%e7%9a%84%e6%97%a5%e5%bf%97">#&lt;/a>
&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>journalctl -u nginx
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="自由组合约束条件">
 自由组合约束条件
 &lt;a class="anchor" href="#%e8%87%aa%e7%94%b1%e7%bb%84%e5%90%88%e7%ba%a6%e6%9d%9f%e6%9d%a1%e4%bb%b6">#&lt;/a>
&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>journalctl -u nginx --since &lt;span style="color:#e6db74">&amp;#39;2023-01-15 00:00:00&amp;#39;&lt;/span> --until &lt;span style="color:#e6db74">&amp;#39;2023-01-15 12:00:00&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="查看日志占用磁盘量">
 查看日志占用磁盘量
 &lt;a class="anchor" href="#%e6%9f%a5%e7%9c%8b%e6%97%a5%e5%bf%97%e5%8d%a0%e7%94%a8%e7%a3%81%e7%9b%98%e9%87%8f">#&lt;/a>
&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>journalctl --disk-usage
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>Output
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>Archived and active journals take up 3.9G in the file system.
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="删除旧的日志">
 删除旧的日志
 &lt;a class="anchor" href="#%e5%88%a0%e9%99%a4%e6%97%a7%e7%9a%84%e6%97%a5%e5%bf%97">#&lt;/a>
&lt;/h2>
&lt;h3 id="只保留最近-一个月-的日志">
 只保留最近 &lt;code>一个月&lt;/code> 的日志
 &lt;a class="anchor" href="#%e5%8f%aa%e4%bf%9d%e7%95%99%e6%9c%80%e8%bf%91-%e4%b8%80%e4%b8%aa%e6%9c%88-%e7%9a%84%e6%97%a5%e5%bf%97">#&lt;/a>
&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>journalctl --vacuum-time&lt;span style="color:#f92672">=&lt;/span>1month
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="只保留最近-1g-的日志">
 只保留最近 &lt;code>1G&lt;/code> 的日志
 &lt;a class="anchor" href="#%e5%8f%aa%e4%bf%9d%e7%95%99%e6%9c%80%e8%bf%91-1g-%e7%9a%84%e6%97%a5%e5%bf%97">#&lt;/a>
&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>journalctl --vacuum-size&lt;span style="color:#f92672">=&lt;/span>1G
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="列出所有systemd服务">
 列出所有systemd服务
 &lt;a class="anchor" href="#%e5%88%97%e5%87%ba%e6%89%80%e6%9c%89systemd%e6%9c%8d%e5%8a%a1">#&lt;/a>
&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>systemctl list-units --type&lt;span style="color:#f92672">=&lt;/span>service --all
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item></channel></rss>